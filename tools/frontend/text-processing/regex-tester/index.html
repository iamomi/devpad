<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regex Tester & Visualizer Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Scrollbars */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
        }

        ::-webkit-scrollbar-thumb {
            background: #374151;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4b5563;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .input-area {
            background-color: #1e293b;
            border: 1px solid #334155;
            color: #e2e8f0;
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-family: 'Fira Code', monospace;
            width: 100%;
            outline: none;
        }

        .input-area:focus {
            border-color: #0ea5e9;
            box-shadow: 0 0 0 2px rgba(14, 165, 233, 0.2);
        }

        .highlight-bg {
            background-color: rgba(14, 165, 233, 0.2);
            border-radius: 2px;
            box-shadow: 0 0 0 1px rgba(14, 165, 233, 0.4);
        }

        .highlight-group-1 {
            background-color: rgba(244, 63, 94, 0.2);
            box-shadow: 0 0 0 1px rgba(244, 63, 94, 0.4);
        }

        .highlight-group-2 {
            background-color: rgba(34, 197, 94, 0.2);
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
        }

        .highlight-group-3 {
            background-color: rgba(234, 179, 8, 0.2);
            box-shadow: 0 0 0 1px rgba(234, 179, 8, 0.4);
        }

        #result-display {
            white-space: pre-wrap;
            min-height: 150px;
        }

        .cheatsheet-item {
            padding: 0.25rem 0;
            border-bottom: 1px solid #334155;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
        }

        .cheatsheet-item code {
            color: #f472b6;
            font-family: 'Fira Code', monospace;
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden">
    <header class="bg-slate-900 border-b border-slate-800 p-4 flex items-center justify-between shrink-0">
        <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-fuchsia-400 to-purple-400">
            Regex Tester & Visualizer Pro
        </h1>
    </header>

    <main class="flex-1 flex overflow-hidden">
        <!-- Main Content -->
        <section class="flex-1 flex flex-col min-w-0 p-6 overflow-y-auto">
            <!-- Regex Input -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-slate-400 mb-2">Regular Expression</label>
                <div class="flex items-center bg-slate-800 rounded-md border border-slate-700 p-2">
                    <span class="text-slate-500 font-mono text-lg px-2">/</span>
                    <input type="text" id="regex-input"
                        class="bg-transparent border-none text-fuchsia-300 font-mono text-lg w-full focus:outline-none"
                        value="([A-Z])\w+" placeholder="Enter regex pattern...">
                    <span class="text-slate-500 font-mono text-lg px-2">/</span>
                    <input type="text" id="regex-flags"
                        class="bg-transparent border-none text-emerald-400 font-mono text-lg w-16 focus:outline-none"
                        value="g" placeholder="flags">
                </div>
                <div id="regex-error" class="text-rose-500 text-xs mt-1 hidden">Invalid Regex</div>
            </div>

            <!-- Test String -->
            <div class="mb-6 flex-1 flex flex-col min-h-[200px]">
                <label class="block text-sm font-medium text-slate-400 mb-2">Test String</label>
                <div class="relative flex-1">
                    <textarea id="test-string"
                        class="input-area h-full absolute inset-0 bg-transparent z-10 resize-none"
                        spellcheck="false">Hello World! This is a Regex Test.</textarea>
                    <div id="result-display"
                        class="input-area h-full text-transparent z-0 pointer-events-none border-transparent"></div>
                </div>
            </div>

            <!-- Match Info -->
            <div class="h-48 bg-slate-900 border border-slate-800 rounded-md p-4 overflow-y-auto shrink-0">
                <h3 class="text-xs font-bold text-slate-500 uppercase mb-2">Match Information</h3>
                <div id="match-list" class="space-y-2 text-sm font-mono">
                    <!-- Matches injected here -->
                </div>
            </div>
        </section>

        <!-- Sidebar: Cheatsheet -->
        <aside class="w-72 bg-slate-950 border-l border-slate-800 overflow-y-auto p-4 shrink-0">
            <h2 class="text-lg font-semibold text-slate-300 mb-4 border-b border-slate-800 pb-2">Cheatsheet</h2>
            <div class="space-y-1">
                <div class="cheatsheet-item"><span>Any character</span><code>.</code></div>
                <div class="cheatsheet-item"><span>Word char</span><code>\w</code></div>
                <div class="cheatsheet-item"><span>Digit</span><code>\d</code></div>
                <div class="cheatsheet-item"><span>Whitespace</span><code>\s</code></div>
                <div class="cheatsheet-item"><span>Start of line</span><code>^</code></div>
                <div class="cheatsheet-item"><span>End of line</span><code>$</code></div>
                <div class="cheatsheet-item"><span>Zero or more</span><code>*</code></div>
                <div class="cheatsheet-item"><span>One or more</span><code>+</code></div>
                <div class="cheatsheet-item"><span>Optional</span><code>?</code></div>
                <div class="cheatsheet-item"><span>Group</span><code>(...)</code></div>
                <div class="cheatsheet-item"><span>Character set</span><code>[...]</code></div>
                <div class="cheatsheet-item"><span>Range</span><code>[a-z]</code></div>
                <div class="cheatsheet-item"><span>Or</span><code>|</code></div>
                <div class="cheatsheet-item"><span>Escape</span><code>\</code></div>
            </div>

            <h2 class="text-lg font-semibold text-slate-300 mt-6 mb-4 border-b border-slate-800 pb-2">Flags</h2>
            <div class="space-y-1">
                <div class="cheatsheet-item"><span>Global</span><code>g</code></div>
                <div class="cheatsheet-item"><span>Case insensitive</span><code>i</code></div>
                <div class="cheatsheet-item"><span>Multiline</span><code>m</code></div>
                <div class="cheatsheet-item"><span>Dot matches all</span><code>s</code></div>
                <div class="cheatsheet-item"><span>Unicode</span><code>u</code></div>
                <div class="cheatsheet-item"><span>Sticky</span><code>y</code></div>
            </div>
        </aside>
    </main>

    <script>
        const regexInput = document.getElementById('regex-input');
        const regexFlags = document.getElementById('regex-flags');
        const testString = document.getElementById('test-string');
        const resultDisplay = document.getElementById('result-display');
        const matchList = document.getElementById('match-list');
        const regexError = document.getElementById('regex-error');

        function update() {
            const pattern = regexInput.value;
            const flags = regexFlags.value;
            const text = testString.value;

            try {
                regexError.classList.add('hidden');
                const regex = new RegExp(pattern, flags);

                // Highlight
                let highlightedHtml = escapeHtml(text);
                let matches = [];

                // We need to find all matches to highlight and list them
                // If global flag is set, we use matchAll or exec loop
                // If not, just exec once

                if (pattern) {
                    let match;
                    // Reset lastIndex if global
                    if (flags.includes('g')) {
                        matches = [...text.matchAll(regex)];
                    } else {
                        const m = regex.exec(text);
                        if (m) matches = [m];
                    }
                }

                // Generate Highlight HTML
                // We need to reconstruct the string with spans
                // This is tricky because matches can overlap if not careful, but JS regex matches don't overlap in a single pass

                let lastIndex = 0;
                let html = '';

                matches.forEach((match, index) => {
                    const start = match.index;
                    const end = start + match[0].length;

                    // Text before match
                    html += escapeHtml(text.substring(lastIndex, start));

                    // Match
                    html += `<span class="highlight-bg" title="Match ${index + 1}">${escapeHtml(match[0])}</span>`;

                    lastIndex = end;
                });

                html += escapeHtml(text.substring(lastIndex));

                // Update display (handle newlines for textarea sync)
                resultDisplay.innerHTML = html + '<br>'; // Add br to match textarea behavior

                // Update Match List
                matchList.innerHTML = '';
                if (matches.length === 0) {
                    matchList.innerHTML = '<div class="text-slate-500 italic">No matches found.</div>';
                } else {
                    matches.forEach((match, i) => {
                        const div = document.createElement('div');
                        div.className = 'border-b border-slate-800 pb-2 mb-2';

                        let groupsHtml = '';
                        if (match.length > 1) {
                            groupsHtml = '<div class="ml-4 mt-1 space-y-1">';
                            for (let g = 1; g < match.length; g++) {
                                groupsHtml += `<div class="text-xs text-slate-400">Group ${g}: <span class="text-emerald-400">${escapeHtml(match[g])}</span></div>`;
                            }
                            groupsHtml += '</div>';
                        }

                        div.innerHTML = `
                            <div class="flex items-center gap-2">
                                <span class="bg-sky-900 text-sky-200 text-xs px-1 rounded">#${i + 1}</span>
                                <span class="text-slate-300 break-all">${escapeHtml(match[0])}</span>
                                <span class="text-slate-500 text-xs ml-auto">Index: ${match.index}</span>
                            </div>
                            ${groupsHtml}
                        `;
                        matchList.appendChild(div);
                    });
                }

            } catch (e) {
                regexError.textContent = e.message;
                regexError.classList.remove('hidden');
                resultDisplay.innerHTML = escapeHtml(text);
                matchList.innerHTML = '';
            }
        }

        function escapeHtml(text) {
            if (!text) return '';
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Sync scroll
        testString.addEventListener('scroll', () => {
            resultDisplay.scrollTop = testString.scrollTop;
            resultDisplay.scrollLeft = testString.scrollLeft;
        });

        regexInput.addEventListener('input', update);
        regexFlags.addEventListener('input', update);
        testString.addEventListener('input', update);

        update();
    </script>
</body>

</html>