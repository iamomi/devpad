<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Formatter & Validator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Scrollbars */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
        }

        ::-webkit-scrollbar-thumb {
            background: #374151;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4b5563;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .editor-pane {
            font-family: 'Fira Code', monospace;
            background-color: #1e293b;
            color: #e2e8f0;
            resize: none;
            outline: none;
            white-space: pre;
            overflow: auto;
        }

        .line-numbers {
            font-family: 'Fira Code', monospace;
            background-color: #0f172a;
            color: #64748b;
            text-align: right;
            padding-right: 0.5rem;
            border-right: 1px solid #334155;
            user-select: none;
        }

        .error-marker {
            background-color: rgba(244, 63, 94, 0.2);
            border-left: 2px solid #f43f5e;
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden">
    <header class="bg-slate-900 border-b border-slate-800 p-4 flex items-center justify-between shrink-0">
        <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-400">
            JSON Formatter & Validator
        </h1>
        <div class="flex gap-2">
            <select id="indent-size"
                class="bg-slate-800 text-slate-300 text-sm rounded px-2 border border-slate-700 focus:outline-none">
                <option value="2">2 Spaces</option>
                <option value="4">4 Spaces</option>
                <option value="tab">Tab</option>
            </select>
            <button id="format-btn"
                class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-1.5 rounded text-sm font-medium transition-colors">
                Format
            </button>
            <button id="minify-btn"
                class="bg-sky-600 hover:bg-sky-700 text-white px-4 py-1.5 rounded text-sm font-medium transition-colors">
                Minify
            </button>
            <button id="copy-btn"
                class="bg-slate-700 hover:bg-slate-600 text-white px-4 py-1.5 rounded text-sm font-medium transition-colors">
                Copy
            </button>
        </div>
    </header>

    <main class="flex-1 flex flex-col overflow-hidden relative">
        <div id="status-bar"
            class="bg-slate-900 border-b border-slate-800 px-4 py-2 text-xs flex justify-between items-center shrink-0">
            <span id="status-msg" class="text-slate-400">Ready</span>
            <span id="stats-msg" class="text-slate-500 font-mono">Size: 0 B</span>
        </div>

        <div class="flex-1 flex overflow-hidden relative">
            <!-- Line Numbers -->
            <div id="line-numbers" class="line-numbers w-12 py-4 text-xs leading-6 shrink-0 overflow-hidden">1</div>

            <!-- Editor -->
            <textarea id="editor" class="editor-pane flex-1 p-4 text-sm leading-6" spellcheck="false"
                placeholder="Paste JSON here..."></textarea>
        </div>
    </main>

    <script>
        const editor = document.getElementById('editor');
        const lineNumbers = document.getElementById('line-numbers');
        const statusMsg = document.getElementById('status-msg');
        const statsMsg = document.getElementById('stats-msg');
        const indentSelect = document.getElementById('indent-size');

        // Sync Scroll
        editor.addEventListener('scroll', () => {
            lineNumbers.scrollTop = editor.scrollTop;
        });

        // Update Line Numbers
        function updateLineNumbers() {
            const lines = editor.value.split('\n').length;
            lineNumbers.innerHTML = Array(lines).fill(0).map((_, i) => i + 1).join('<br>');
        }

        editor.addEventListener('input', () => {
            updateLineNumbers();
            updateStats();
            validateJSON(true); // Passive validation
        });

        function updateStats() {
            const size = new Blob([editor.value]).size;
            statsMsg.textContent = `Size: ${formatBytes(size)}`;
        }

        function validateJSON(passive = false) {
            const text = editor.value.trim();
            if (!text) {
                statusMsg.textContent = 'Ready';
                statusMsg.className = 'text-slate-400';
                return true;
            }

            try {
                JSON.parse(text);
                statusMsg.textContent = 'Valid JSON';
                statusMsg.className = 'text-emerald-400 font-bold';
                return true;
            } catch (e) {
                statusMsg.textContent = passive ? 'Invalid JSON' : `Error: ${e.message}`;
                statusMsg.className = 'text-rose-400 font-bold';
                return false;
            }
        }

        document.getElementById('format-btn').addEventListener('click', () => {
            const text = editor.value;
            try {
                const obj = JSON.parse(text);
                let space = indentSelect.value === 'tab' ? '\t' : parseInt(indentSelect.value);
                editor.value = JSON.stringify(obj, null, space);
                validateJSON();
                updateLineNumbers();
                updateStats();
            } catch (e) {
                alert('Cannot format: Invalid JSON');
            }
        });

        document.getElementById('minify-btn').addEventListener('click', () => {
            const text = editor.value;
            try {
                const obj = JSON.parse(text);
                editor.value = JSON.stringify(obj);
                validateJSON();
                updateLineNumbers();
                updateStats();
            } catch (e) {
                alert('Cannot minify: Invalid JSON');
            }
        });

        document.getElementById('copy-btn').addEventListener('click', () => {
            navigator.clipboard.writeText(editor.value);
            const btn = document.getElementById('copy-btn');
            const original = btn.textContent;
            btn.textContent = 'Copied!';
            setTimeout(() => btn.textContent = original, 1500);
        });

        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }

        // Init
        updateLineNumbers();
    </script>
</body>

</html>